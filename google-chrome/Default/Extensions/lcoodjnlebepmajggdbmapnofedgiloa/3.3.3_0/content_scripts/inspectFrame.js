(()=>{"use strict";var e={};function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e);const r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isOffline=!1,this.isOffline=null!=t&&t}var r,i,a;return r=e,a=[{key:"listener",value:function(e,n,r){if("get-attributes"===e.action){var i,a=e.selector;if(null!==(i=window._AQAExt_)&&void 0!==i&&i.u$){var o=window._AQAExt_.u$(a);if(o.length){var l=function(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,a=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){l=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(l)throw i}}return a}}(e,n)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(o,1)[0];if(l){var u=l.attributes,f=[];Array.prototype.slice.call(u).forEach((function(e){f.push({name:e.name,value:e.value})}));var c=l.tagName,s=l.innerText&&""!==l.innerText.trim()||["SELECT","TEXTAREA","BUTTON"].includes(c)||l instanceof HTMLInputElement&&"text"===l.type.toLowerCase();r({attributes:f,outerHTML:o[0].outerHTML,hasText:s,tagName:l.tagName.toLowerCase()})}}}}}},{key:"isIframe",value:function(){try{return window.parent!==window&&window.parent.window.parent.window===window.parent}catch(e){return!0}}},{key:"getFrameElement",value:function(){try{return window.frameElement}catch(e){return null}}},{key:"bindListener",value:function(){chrome.runtime.onMessage.removeListener(e.listener),chrome.runtime.onMessage.addListener(e.listener)}},{key:"amIVisible",value:function(){var t=e.getFrameElement();if(t){var n=window.getComputedStyle(t);if("none"===n.display||"hidden"===n.visibility)return!1}return!(window.innerHeight<10||window.innerWidth<10)}}],(i=[{key:"addFrame",value:function(){e.isIframe()&&document.body&&e.amIVisible()&&""!==document.body.innerHTML.trim()&&chrome.runtime.sendMessage({action:"new-frame",name:this.getFrameName(),url:window.location.href})}},{key:"getFrameName",value:function(){var t=e.getFrameElement();if(t){var n,r,i,a=t.getAttribute("id"),o=t.getAttribute("name"),l=t.getAttribute("class"),u=t.getAttribute("src");return null!==(n=null!==(r=null!==(i=null!=a?a:o)&&void 0!==i?i:l)&&void 0!==r?r:u)&&void 0!==n?n:""}return this.isOffline?"offline":window.location.href}}])&&n(r.prototype,i),a&&n(r,a),Object.defineProperty(r,"prototype",{writable:!1}),e}();var i=new r;r.bindListener(),i.addFrame();var a=window;for(var o in e)a[o]=e[o];e.__esModule&&Object.defineProperty(a,"__esModule",{value:!0})})();